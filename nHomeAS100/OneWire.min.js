var __extends=this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);r.prototype=t.prototype,n.prototype=new r},fs=require("fs"),OneWire;(function(n){var r=function(){function n(){this._rootPath="",this._owdeviceidregex="[A-F0-9]{2}.[A-F0-9]{12}",this._devices=[]}return n.getInstance=function(){return this._instance==null&&(this._instance=new n),this._instance},n.prototype.getDevices=function(n){return this._rootPath=n,this.fetchDevices(),this._devices},n.prototype.getDeviceById=function(n){for(var t in this._devices)if(this._devices[t].getId()===n)return this._devices[t];return null},n.prototype.getDeviceByAlias=function(n){for(var t in this._devices)if(this._devices[t].getAlias()===n)return this._devices[t];return null},n.prototype.getDevicesByFamily=function(n){var t=[];return this._devices.forEach(function(i){i.getFamily()===n&&t.push(i)}),t},n.prototype.fetchDevices=function(){var n=fs.readdirSync(this._rootPath),f=new RegExp(this._owdeviceidregex),i,r,u;for(i in n)f.test(n[i])&&(r=this._rootPath+"/"+n[i],u=new t(r),this._devices.push(u),console.log("OneWire:","this ["+r+"] is onewire device"))},n}(),t,i;n.DeviceManager=r,t=function(){function n(n){this.path=n,this._devicepath=n,this.initDevice()}return n.prototype.initDevice=function(){this._id=fs.readFileSync(this._devicepath+"/id","ascii"),this._family=fs.readFileSync(this._devicepath+"/family","ascii"),this._crc=fs.readFileSync(this._devicepath+"/crc8","ascii"),this._address=fs.readFileSync(this._devicepath+"/address","ascii"),this._type=fs.readFileSync(this._devicepath+"/type","ascii"),this._alias=fs.readFileSync(this._devicepath+"/alias","ascii"),console.log("OneWire:","id:"+this._id)},n.prototype.getDevicePath=function(){return this._devicepath},n.prototype.getId=function(){return this._id},n.prototype.getFamily=function(){return this._family},n.prototype.getCRC=function(){return this._crc},n.prototype.getAddress=function(){return this._address},n.prototype.getType=function(){return this._type},n.prototype.getAlias=function(){return this._alias},n.prototype.setAlias=function(n){try{fs.writeFileSync(this._devicepath+"/alias",n),this._alias=n,console.log("OneWire:","Device alias:"+this._alias);var t=""+this._devicepath;return this._devicepath=t.replace(this._id,this._alias),console.log("OneWire:","Device Path :"+this._devicepath),!0}catch(i){return!1}},n.prototype.renderControl=function(){return"ID: "+this._id+" Type: "+this._type+" Family: "+this._family},n}(),n.OneWireDevice=t,i=function(n){function t(t){n.call(this,t),this.path=t,this._pios=Array(),this._channels=0}return __extends(t,n),t.prototype.getChannels=function(){return this._channels=fs.readFileSync(n.prototype.getDevicePath.call(this)+"/channels","ascii"),this._channels},t.prototype.getChannelState=function(){return!0},t.prototype.setPIOState=function(){},t.prototype.renderControl=function(){return n.prototype.renderControl.call(this)},t}(t),n.AddressableSwitch=i})(exports.OneWire||(exports.OneWire={})),OneWire=exports.OneWire,exports.OneWire=OneWire